<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Tirage au sort d'√©l√®ves</title>
<style>
    body { font-family: Arial, sans-serif; margin: 40px; }
    h1 { color: #333; }
    #result { margin-top: 20px; font-size: 1.2em; }
</style>
</head>
<body>

<h1>Tirage au sort d'√©l√®ves</h1>

<div id="status">Chargement de la liste‚Ä¶</div>

<label for="k">Nombre d'√©l√®ves √† tirer :</label>
<input type="number" id="k" min="1" value="1"><br><br>

<button onclick="tirer()">üé≤ Tirer au hasard</button>

<div id="result"></div>

<script>
let eleves = [];

// üî• Charge automatiquement le fichier prenoms.csv
fetch("prenoms.csv?cachebuster=" + Date.now())
    .then(response => response.text())
    .then(text => {
        eleves = text.split(/\r?\n/).map(l => l.trim()).filter(l => l.length > 0);
        document.getElementById("status").innerHTML =
            "Liste charg√© : " + eleves.length + " √©l√®ves.";
    })
    .catch(err => {
        document.getElementById("status").innerHTML =
            "<span style='color:red'>Erreur : impossible de charger prenoms.csv</span>";
        console.error(err);
    });

function tirer() {
    const k = parseInt(document.getElementById('k').value);
    const resultDiv = document.getElementById('result');

    if (eleves.length === 0) {
        resultDiv.innerHTML = "<span style='color:red'>‚ö†Ô∏è Liste non charg√©e.</span>";
        return;
    }

    if (k < 1 || k > eleves.length) {
        resultDiv.innerHTML = "<span style='color:red'>‚ö†Ô∏è Choisis un k entre 1 et " + eleves.length + ".</span>";
        return;
    }

    const copie = [...eleves];

    // M√©lange Fisher-Yates
    for (let i = copie.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [copie[i], copie[j]] = [copie[j], copie[i]];
    }

    const tirage = copie.slice(0, k);

    resultDiv.innerHTML = "<h2>√âl√®ves tir√©s :</h2><ul>" +
        tirage.map(n => "<li>" + n + "</li>").join("") +
        "</ul>";
}
</script>

</body>
</html>
